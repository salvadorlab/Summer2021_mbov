import_num <- import_num %>% left_join(cluster_no_lookup,by = c("fastbaps"))
cluster_box <- ggplot(import_num, aes(x=cluster_ext, y=X0, fill=factor(fastbaps))) +
geom_boxplot() +
labs(y="Number of HR regions") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Population Clusters") +
coord_flip() +
scale_fill_grey()
grid.arrange(country_box,species_box,cluster_box,nrow = 2)
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
accession_meta <- read.csv("../dependencies/ProjectBovisReservoir_metadata.csv", header = TRUE, stringsAsFactors = FALSE)
import_num <- import_num %>% left_join(isolate_dat,by = c("label"= "Sample"))
import_num <- import_num %>% left_join(gc_content,by = c("label"="V1")) %>% drop_na()
country_no_lookup <- import_num %>% group_by(Country) %>% summarise(n=n()) %>% mutate(country_ext = paste0(Country," (",n,")"))
import_num <- import_num %>% left_join(country_no_lookup,by = c("Country"))
country_box <- ggplot(import_num, aes(x=country_ext, y=X0, fill=Country)) +
geom_boxplot() +
labs(y="# HR regions") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Country") +
coord_flip() +
scale_fill_grey()
species_no_lookup <- import_num %>% group_by(Species) %>% summarise(n=n()) %>% mutate(species_ext = paste0(Species," (",n,")"))
import_num <- import_num %>% left_join(species_no_lookup,by = c("Species"))
species_box <- ggplot(subset(import_num,import_num$Species != "STOAT"), aes(x=species_ext, y=X0, fill=Species)) +
geom_boxplot() +
labs(y="# HR regions") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Species") +
coord_flip() +
scale_fill_grey()
cluster_no_lookup <- import_num %>% group_by(fastbaps) %>% summarise(n=n()) %>% mutate(cluster_ext = paste0(fastbaps," (",n,")"))
import_num <- import_num %>% left_join(cluster_no_lookup,by = c("fastbaps"))
cluster_box <- ggplot(import_num, aes(x=cluster_ext, y=X0, fill=factor(fastbaps))) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "C") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Population Clusters") +
coord_flip() +
scale_fill_grey()
grid.arrange(country_box,species_box,cluster_box,nrow = 2)
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
accession_meta <- read.csv("../dependencies/ProjectBovisReservoir_metadata.csv", header = TRUE, stringsAsFactors = FALSE)
import_num <- import_num %>% left_join(isolate_dat,by = c("label"= "Sample"))
import_num <- import_num %>% left_join(gc_content,by = c("label"="V1")) %>% drop_na()
country_no_lookup <- import_num %>% group_by(Country) %>% summarise(n=n()) %>% mutate(country_ext = paste0(Country," (",n,")"))
import_num <- import_num %>% left_join(country_no_lookup,by = c("Country"))
country_box <- ggplot(import_num, aes(x=country_ext, y=X0, fill=Country)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "A") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Country") +
coord_flip() +
scale_fill_grey()
species_no_lookup <- import_num %>% group_by(Species) %>% summarise(n=n()) %>% mutate(species_ext = paste0(Species," (",n,")"))
import_num <- import_num %>% left_join(species_no_lookup,by = c("Species"))
species_box <- ggplot(subset(import_num,import_num$Species != "STOAT"), aes(x=species_ext, y=X0, fill=Species)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "B") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Species") +
coord_flip() +
scale_fill_grey()
cluster_no_lookup <- import_num %>% group_by(fastbaps) %>% summarise(n=n()) %>% mutate(cluster_ext = paste0(fastbaps," (",n,")"))
import_num <- import_num %>% left_join(cluster_no_lookup,by = c("fastbaps"))
cluster_box <- ggplot(import_num, aes(x=cluster_ext, y=X0, fill=factor(fastbaps))) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "C") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Clusters") +
coord_flip() +
scale_fill_grey()
grid.arrange(country_box,species_box,cluster_box,nrow = 2)
View(op_dat_extend)
write.csv("SupplementaryFile7_OmegaPlusData.csv",op_dat_extend)
write.csv(op_dat_extend,"SupplementaryFile7_OmegaPlusData.csv")
View(df)
View(hr_perc)
final_tree
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
accession_meta <- read.csv("../dependencies/filtered_isolate_list.csv", header = TRUE, stringsAsFactors = FALSE)
import_num <- import_num %>% left_join(isolate_dat,by = c("label"= "Sample"))
import_num <- import_num %>% left_join(gc_content,by = c("label"="V1")) %>% drop_na()
country_no_lookup <- import_num %>% group_by(Country) %>% summarise(n=n()) %>% mutate(country_ext = paste0(Country," (",n,")"))
import_num <- import_num %>% left_join(country_no_lookup,by = c("Country"))
country_box <- ggplot(import_num, aes(x=country_ext, y=X0, fill=Country)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "A") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Country") +
coord_flip() +
scale_fill_grey()
species_no_lookup <- import_num %>% group_by(Species) %>% summarise(n=n()) %>% mutate(species_ext = paste0(Species," (",n,")"))
import_num <- import_num %>% left_join(species_no_lookup,by = c("Species"))
species_box <- ggplot(subset(import_num,import_num$Species != "STOAT"), aes(x=species_ext, y=X0, fill=Species)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "B") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Species") +
coord_flip() +
scale_fill_grey()
cluster_no_lookup <- import_num %>% group_by(fastbaps) %>% summarise(n=n()) %>% mutate(cluster_ext = paste0(fastbaps," (",n,")"))
import_num <- import_num %>% left_join(cluster_no_lookup,by = c("fastbaps"))
cluster_box <- ggplot(import_num, aes(x=cluster_ext, y=X0, fill=factor(fastbaps))) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "C") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Clusters") +
coord_flip() +
scale_fill_grey()
grid.arrange(country_box,species_box,cluster_box,nrow = 2)
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
accession_meta <- read.csv("../dependencies/filtered_isolate_list.csv", header = TRUE, stringsAsFactors = FALSE)
import_num <- import_num %>% left_join(isolate_dat,by = c("label"= "Sample"))
import_num <- import_num %>% left_join(gc_content,by = c("label"="V1")) %>% drop_na()
country_no_lookup <- import_num %>% group_by(Country) %>% summarise(n=n()) %>% mutate(country_ext = paste0(Country," (",n,")"))
import_num <- import_num %>% left_join(country_no_lookup,by = c("Country"))
country_box <- ggplot(import_num, aes(x=country_ext, y=X0, fill=Country)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "A") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Country") +
coord_flip() +
scale_fill_grey()
species_no_lookup <- import_num %>% group_by(Species) %>% summarise(n=n()) %>% mutate(species_ext = paste0(Species," (",n,")"))
import_num <- import_num %>% left_join(species_no_lookup,by = c("Species"))
species_box <- ggplot(subset(import_num,import_num$Species != "STOAT"), aes(x=species_ext, y=X0, fill=Species)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "B") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Species") +
coord_flip() +
scale_fill_grey()
cluster_no_lookup <- import_num %>% group_by(fastbaps) %>% summarise(n=n()) %>% mutate(cluster_ext = paste0(fastbaps," (",n,")"))
import_num <- import_num %>% left_join(cluster_no_lookup,by = c("fastbaps"))
cluster_box <- ggplot(import_num, aes(x=cluster_ext, y=X0, fill=factor(fastbaps))) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "C") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Clusters") +
coord_flip() +
scale_fill_grey()
grid.arrange(country_box,species_box,cluster_box,nrow = 2)
View(import_num)
View(import_num)
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
accession_meta <- read.csv("../dependencies/filtered_isolate_list.csv", header = TRUE, stringsAsFactors = FALSE)
import_num <- import_num %>% left_join(isolate_dat,by = c("label"= "Sample"))
import_num <- import_num %>% left_join(gc_content,by = c("label"="V1")) %>% drop_na()
country_no_lookup <- import_num %>% group_by(Country) %>% summarise(n=n()) %>% mutate(country_ext = paste0(Country," (",n,")"))
import_num <- import_num %>% left_join(country_no_lookup,by = c("Country"))
country_box <- ggplot(import_num, aes(x=country_ext, y=X0, fill=Country)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "A") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Country") +
coord_flip() +
scale_fill_grey()
species_no_lookup <- import_num %>% group_by(Species) %>% summarise(n=n()) %>% mutate(species_ext = paste0(Species," (",n,")"))
import_num <- import_num %>% left_join(species_no_lookup,by = c("Species"))
species_box <- ggplot(subset(import_num,import_num$Species != "STOAT"), aes(x=species_ext, y=X0, fill=Species)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "B") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Species") +
coord_flip() +
scale_fill_grey()
cluster_no_lookup <- import_num %>% group_by(fastbaps) %>% summarise(n=n()) %>% mutate(cluster_ext = paste0(fastbaps," (",n,")"))
import_num <- import_num %>% left_join(cluster_no_lookup,by = c("fastbaps"))
cluster_box <- ggplot(import_num, aes(x=cluster_ext, y=X0, fill=factor(fastbaps))) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "C") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Clusters") +
coord_flip() +
scale_fill_grey()
grid.arrange(country_box,species_box,cluster_box,nrow = 2)
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
View(import_num)
import_num <- read.csv("../dependencies/isolate_import_num.csv",header = TRUE)
accession_meta <- read.csv("../dependencies/filtered_isolate_list.csv", header = TRUE, stringsAsFactors = FALSE)
import_num <- import_num %>% left_join(isolate_dat,by = c("label"= "Sample"))
country_no_lookup <- import_num %>% group_by(Country) %>% summarise(n=n()) %>% mutate(country_ext = paste0(Country," (",n,")"))
import_num <- import_num %>% left_join(country_no_lookup,by = c("Country"))
country_box <- ggplot(import_num, aes(x=country_ext, y=X0, fill=Country)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "A") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Country") +
coord_flip() +
scale_fill_grey()
species_no_lookup <- import_num %>% group_by(Species) %>% summarise(n=n()) %>% mutate(species_ext = paste0(Species," (",n,")"))
import_num <- import_num %>% left_join(species_no_lookup,by = c("Species"))
species_box <- ggplot(subset(import_num,import_num$Species != "STOAT"), aes(x=species_ext, y=X0, fill=Species)) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "B") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Species") +
coord_flip() +
scale_fill_grey()
cluster_no_lookup <- import_num %>% group_by(fastbaps) %>% summarise(n=n()) %>% mutate(cluster_ext = paste0(fastbaps," (",n,")"))
import_num <- import_num %>% left_join(cluster_no_lookup,by = c("fastbaps"))
cluster_box <- ggplot(import_num, aes(x=cluster_ext, y=X0, fill=factor(fastbaps))) +
geom_boxplot() +
labs(y="# HR regions") +
labs(tag = "C") +
theme(axis.text = element_text(size = 15),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 15),
axis.title.x = element_text(size = 15),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
plot.title = element_text(hjust = 0.5, size = 15)) +
xlab("Clusters") +
coord_flip() +
scale_fill_grey()
grid.arrange(country_box,species_box,cluster_box,nrow = 2)
#compute avg. for each class
op_dat <- rbind(op_US,op_UK,op_NZ,op_badger,op_deer,op_possum,op_1,op_2,op_3,op_4,op_5,op_6,op_7,op_8)
op_dat$coords <- floor(as.numeric(rownames(op_dat)))
colnames(op_dat)[1] <- "omega"
avg_lookup <- op_dat  %>% group_by(class) %>% summarise(avg=mean(omega),std=sd(omega),number=n())
op_dat_extend <- op_dat %>% left_join(avg_lookup,by="class") %>%
mutate(zscore = ((omega - avg)/std)) %>% mutate(p_value = pnorm(zscore, mean = avg, sd = std, lower.tail = FALSE)) %>% mutate(pval.adj = p.adjust(p_value, method='BH'))
op_dat_extend$log_p <- (-1*log10(op_dat_extend$p_value))
#op_dat_extend %>% select(omega,class,coords,p_value) %>% filter(class == "NZ" | class == "possum" | class == "7") %>% ggplot(aes(x=p_value)) + geom_histogram()
bonferroni_corrected = 0.05/5000
ss_out.tbl <- op_dat_extend %>% select(omega,class,coords,pval.adj,log_p) %>% filter(pval.adj < 0.05 & omega > 50)
write.csv(ss_out.tbl, "../dependencies/mbov_ss.csv")
for (group in 1:length(unique(op_dat$class))){
current <- unique(op_dat$class)[group]
op_gg <- op_dat_extend %>% filter(class == current) %>% ggplot(aes(x=floor(as.numeric(coords)),y=log_p)) + geom_point() +
theme_minimal() +
xlab("genomic position") +
ylab("-log10(P)") +
geom_hline(yintercept=7.3, linetype="dashed", color = "black") +
ggtitle(current)
plot(op_gg) }
op_fig <- op_dat_extend %>% mutate(Color = ifelse(log_p > 6.3, "black", "gray")) %>% ggplot(aes(x=floor(as.numeric(coords)),y=log_p,color=Color)) + geom_point() +
theme_minimal() +
theme(axis.title = element_text(size = 15)) +
xlab("genomic position") +
ylab("-log10(P)") +
scale_color_identity() +
facet_wrap(~ class, ncol = 3)
# Should we just do this based off of a p-value threshold?
# https://academic.oup.com/g3journal/article/11/2/jkaa056/6080665
plot(op_fig)
plot(op_fig)
setwd("../dependencies/")
hr_stats <- read.csv("recombination_stats.csv")
import_gg <- hr_stats %>% ggplot(aes(x=Import.Length,)) +
geom_histogram(binwidth = 10,fill = "steelblue") +
theme_minimal() +
xlab("length of homologous recombination region") + labs(tag = "A")
snp_size_gg <- hr_stats %>% ggplot(aes(x=No..SNPs,)) +
geom_histogram(binwidth = 1,fill = "steelblue") +
theme_minimal() +
xlab("# SNPs within a homologous recombination region") + labs(tag = "B")
supfig1 <- grid.arrange(import_gg,snp_size_gg,nrow=1)
plot(supfig1)
setwd("../dependencies/")
hr_stats <- read.csv("recombination_stats.csv")
import_gg <- hr_stats %>% ggplot(aes(x=Import.Length,)) +
geom_histogram(binwidth = 10,fill = "steelblue") +
theme_minimal() +
xlab("length of homologous recombination region") + labs(tag = "A")
snp_size_gg <- hr_stats %>% ggplot(aes(x=No..SNPs,)) +
geom_histogram(binwidth = 1,fill = "steelblue") +
theme_minimal() +
xlab("# SNPs within a homologous recombination region") + labs(tag = "B")
grid.arrange(import_gg,snp_size_gg,nrow=1)
setwd("../dependencies/")
hr_stats <- read.csv("recombination_stats.csv")
import_gg <- hr_stats %>% ggplot(aes(x=Import.Length,)) +
geom_histogram(binwidth = 10,fill = "steelblue") +
theme_minimal() +
xlab("length of homologous recombination region") + labs(tag = "A")
snp_size_gg <- hr_stats %>% ggplot(aes(x=No..SNPs,)) +
geom_histogram(binwidth = 1,fill = "steelblue") +
theme_minimal() +
xlab("# SNPs within a homologous recombination region") + labs(tag = "B")
grid.arrange(import_gg,snp_size_gg,nrow=1)
setwd("../dependencies/")
hr_stats <- read.csv("recombination_stats.csv")
import_gg <- hr_stats %>% ggplot(aes(x=Import.Length,)) +
geom_histogram(binwidth = 10,fill = "steelblue") +
theme_minimal() +
xlab("length of homologous recombination region") + labs(tag = "A")
snp_size_gg <- hr_stats %>% ggplot(aes(x=No..SNPs,)) +
geom_histogram(binwidth = 1,fill = "steelblue") +
theme_minimal() +
xlab("# SNPs within a homologous recombination region") + labs(tag = "B")
grid.arrange(import_gg,snp_size_gg,nrow=1)
length(hr_stats, Import.Length < 1000)
View(hr_stats)
length(subset(hr_stats, Import.Length < 1000))
length(subset(hr_stats, Import.Length < 1000))$Import.Length
length(subset(hr_stats, Import.Length < 1000)$Import.Length)
length(subset(hr_stats, Import.Length > 1000)$Import.Length)
View(hr_stats)
length(subset(hr_stats, Import.Length < 2500)$Import.Length)
315/(315+27)
max(hr_stats$Import.Length)
length(subset(hr_stats, No..SNPs < 10)$Import.Length)
length(subset(hr_stats, No..SNPs < 12)$Import.Length)
312/(315+27)
View(import_num)
summary(import_num$X0[import_num$Country == "New Zealand"])
summary(import_num$X0[import_num$Country == "USA"])
summary(import_num$X0[import_num$Country == "United Kingdom"])
max(op_dat_extend$omega)
op_dat_extend %>% group_by(class) %>% summarise(omega>1000)
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = omega>1000)
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = n(omega) >1000)
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = n(omega > 1000))
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = count(omega > 1000))
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = count(omega[omega > 1000]))
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = n(omega[omega > 1000]))
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = n(.[omega > 1000]))
op_dat_extend %>% group_by(class) %>% summarise(over_1000 = n(.))
op_dat_extend %>% group_by(class) %>% summarise(n())
op_dat_extend %>% group_by(class) %>% summarise(n(.))
op_dat_extend %>% group_by(class) %>% summarise(n(omega))
op_dat_extend %>% group_by(class) %>% summarise(count())
op_dat_extend %>% group_by(class) %>% summarise(n())
op_dat_extend %>% group_by(class) %>% summarise(count(omega[omega > 1000]))
op_dat_extend %>% group_by(class) %>% summarise(n(omega[omega > 1000]))
op_dat_extend %>% group_by(class) %>% filter (omega > 1000) %>% summarise(n = n())
op_dat_extend %>% group_by(class) %>% summarise(n = mean(omega))
op_dat_extend %>% filter(log_p > 10)
